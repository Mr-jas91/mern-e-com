import{u as V,e as b,a as _,a7 as L,j as e,B as p,T as m,f as D,G as l,R as F,a8 as w,a9 as B,z as P}from"./index-Bg7Lztdd.js";import{C as G,S as H,M as z,T as q,a as Q,b as $,c as N,d as i,e as J}from"./Style-Ccpit8DN.js";import{C as K,D as U,a as X,b as Y,c as Z}from"./DialogTitle-FjZnM06n.js";import{T as t,F as ee,I as se,S as le}from"./TextField-B6hv7PeN.js";import{A as re}from"./Avatar-CnYVAdCw.js";import{M as x}from"./MenuItem-C3_If5kC.js";import"./Modal-BbAonJu_.js";import"./List-DQDaG03M.js";import"./listItemButtonClasses-Wh8hGUTv.js";import"./ListItemText-BEUB2tEs.js";import"./isHostComponent-CIBwoAig.js";const be=()=>{const d=V(),[T,E]=b.useState(!1),[h,v]=b.useState({}),{adminOrders:W,adminOrderDetails:r,loading:k}=_(s=>s.orders);b.useEffect(()=>{d(L())},[d]);const O=async s=>{await d(w(s)),E(!0)},j=()=>{E(!1),v({})},R=async()=>{try{const s=Object.values(h);for(let a of s)(a.deliveryStatus||a.tracking)&&await d(B(a));P("success","Delivery status updated"),j(),d(L())}catch{P("error","Failed to update delivery status")}},C=(s,a)=>{const{name:o,value:u}=s.target;v(c=>({...c,[a]:{...c[a],productId:a,[o]:u}}))},M=r==null?void 0:r.orderItems.every(s=>{const a=s.deliveryStatus;return["DELIVERED","CANCELLED"].includes(a)});return e.jsxs(p,{sx:{display:"flex"},children:[e.jsx(G,{}),e.jsx(H,{}),e.jsxs(z,{children:[e.jsx(q,{}),e.jsx(m,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center",color:"black"},children:"Orders"}),e.jsx(p,{p:2,children:k?e.jsx(p,{textAlign:"center",children:e.jsx(K,{})}):e.jsxs(Q,{children:[e.jsx($,{children:e.jsxs(N,{children:[e.jsx(i,{sx:{color:"black"},children:"Order ID"}),e.jsx(i,{sx:{color:"black"},children:"Customer Name"}),e.jsx(i,{sx:{color:"black"},children:"Order Value"}),e.jsx(i,{sx:{color:"black"},children:"Payment Method"}),e.jsx(i,{sx:{color:"black"},children:"Actions"})]})}),e.jsx(J,{children:W.map(s=>e.jsxs(N,{hover:!0,children:[e.jsx(i,{sx:{color:"black"},children:s._id}),e.jsx(i,{sx:{color:"black"},children:s.shippingAddress.fullName}),e.jsxs(i,{sx:{color:"black"},children:["â‚¹",s.orderPrice.toFixed(2)]}),e.jsx(i,{sx:{color:"black"},children:s.paymentMethod}),e.jsx(i,{children:e.jsx(D,{variant:"outlined",size:"small",onClick:()=>O(s._id),children:"Details"})})]},s._id))})]})}),r&&e.jsxs(U,{open:T,onClose:j,maxWidth:"sm",fullWidth:!0,children:[e.jsx(X,{sx:{color:"black"},children:"Order Details"}),e.jsx(Y,{sx:{color:"black"},children:e.jsxs(l,{container:!0,spacing:2,mt:1,children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(m,{variant:"h6",sx:{color:"black"},children:"Customer Info"})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(t,{label:"Order ID",fullWidth:!0,value:r._id,disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(t,{label:"Name",fullWidth:!0,value:r.shippingAddress.fullName,disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(t,{label:"Mobile",fullWidth:!0,value:r.shippingAddress.mobileNo,disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(t,{label:"Address",fullWidth:!0,value:r.shippingAddress.address,disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(t,{label:"Pincode",fullWidth:!0,value:r.shippingAddress.pincode,disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(t,{label:"Order Date",fullWidth:!0,value:new Date(r.createdAt).toLocaleDateString(),disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(t,{label:"Payment Method",fullWidth:!0,value:r.paymentMethod,disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(m,{variant:"h6",sx:{color:"black"},children:"Product Info"})}),r.orderItems.map((s,a)=>{var o,u,c,g,f,S,y,A;return e.jsxs(F.Fragment,{children:[(u=(o=s.productId)==null?void 0:o.images)==null?void 0:u.slice(0,1).map((n,I)=>e.jsx(l,{item:!0,xs:2,children:e.jsx(re,{variant:"rounded",src:n,alt:`product-${I}`,sx:{width:60,height:60}})},I)),e.jsx(l,{item:!0,xs:10,children:e.jsx(t,{fullWidth:!0,value:((c=s.productId)==null?void 0:c.name)||"",label:"Product Name",disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:4,children:e.jsx(t,{fullWidth:!0,value:((g=s.productId)==null?void 0:g.price)||0,label:"Price",disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:4,children:e.jsx(t,{fullWidth:!0,value:(((f=s.productId)==null?void 0:f.price)||0)-(((S=s.productId)==null?void 0:S.discount)||0),label:"Discount Price",disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:4,children:e.jsx(t,{fullWidth:!0,value:s.quantity,label:"Quantity",disabled:!0,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(t,{fullWidth:!0,name:"tracking",label:"Tracking Link",value:((y=h[s._id])==null?void 0:y.tracking)||s.tracking||"",onChange:n=>C(n,s._id),disabled:!!s.tracking,sx:{input:{color:"black"}}})}),e.jsx(l,{item:!0,xs:12,children:e.jsxs(ee,{fullWidth:!0,children:[e.jsx(se,{children:"Status"}),e.jsxs(le,{name:"deliveryStatus",value:((A=h[s._id])==null?void 0:A.deliveryStatus)||s.deliveryStatus||"",onChange:n=>C(n,s._id),sx:{color:"black"},disabled:["DELIVERED","CANCELLED"].includes(s.deliveryStatus),children:[e.jsx(x,{value:"PENDING",disabled:["ACCEPTED","SHIPPED","DELIVERED","CANCELLED"].includes(s.deliveryStatus),children:"PENDING"}),e.jsx(x,{value:"ACCEPTED",disabled:["SHIPPED","DELIVERED","CANCELLED"].includes(s.deliveryStatus),children:"Accepted"}),e.jsx(x,{value:"SHIPPED",disabled:["DELIVERED","CANCELLED"].includes(s.deliveryStatus),children:"Shipped"}),e.jsx(x,{value:"DELIVERED",disabled:["DELIVERED","CANCELLED"].includes(s.deliveryStatus),children:"Delivered"})]})]})})]},a)})]})}),e.jsxs(Z,{sx:{color:"black"},children:[e.jsx(D,{onClick:j,children:"Close"}),e.jsx(D,{variant:"contained",disabled:k||M,onClick:R,children:"Save"})]})]})]})]})};export{be as default};
